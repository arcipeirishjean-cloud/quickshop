<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>QuickShop Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/main.css">
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  <header class="navbar navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand" href="/">QUICKSHOP</a>
      <div>
        <a class="btn btn-outline-light btn-sm" href="login.html">Login</a>
        <a class="btn btn-outline-light btn-sm" href="index.html">Home</a>
      </div>
    </div>
  </header>

  <main class="container py-5">
    <h2>Admin Dashboard</h2>
    <p id="adminNotice" class="text-muted"></p>

    <section class="mb-5">
      <h4>Add product</h4>
      <form id="adminProductForm" class="row g-3">
        <input type="hidden" id="adminProductId">
        <div class="col-md-6">
          <label class="form-label">Name</label>
          <input class="form-control" id="adminProductName" required>
        </div>
        <div class="col-md-3">
          <label class="form-label">Category</label>
          <input class="form-control" id="adminProductCategory" required>
        </div>
        <div class="col-md-3">
          <label class="form-label">Price</label>
          <input class="form-control" id="adminProductPrice" type="number" step="0.01" required>
        </div>
        <div class="col-12">
          <label class="form-label">Image path (assets/images/...)</label>
          <input class="form-control" id="adminProductImage" placeholder="assets/images/t-shirts/men-shirt.jpg" required>
        </div>
        <div class="col-12">
          <button class="btn btn-primary" type="submit">Save</button>
          <button class="btn btn-secondary" id="adminReset" type="button">Reset demo</button>
        </div>
      </form>
    </section>

    <section>
      <h4>Products</h4>
      <div class="table-responsive">
        <table class="table table-sm">
          <thead><tr><th>Name</th><th>Category</th><th>Price</th><th>Image</th><th>Actions</th></tr></thead>
          <tbody id="adminProducts"></tbody>
        </table>
      </div>
    </section>
  </main>

  <footer class="bg-light py-4 text-center">QuickShop Admin</footer>

  <script>
    // small admin script: reads products from localStorage and edits them
    const LS_PRODUCTS = 'qs_products';
    const DEFAULT_PRODUCTS = [
      { id: 'p1', name: 'Soft Leather Jacket', category: 'Coat', price: 120, image: 'assets/images/coat/banner-image-1.jpg' },
      { id: 'p2', name: 'Baggy Shirt', category: 'T-shirts', price: 55, image: 'assets/images/t-shirts/men-shirt.jpg' }
    ];

    function getProducts() { try { return JSON.parse(localStorage.getItem(LS_PRODUCTS) || 'null') || DEFAULT_PRODUCTS.slice(); } catch(e){ return DEFAULT_PRODUCTS.slice(); } }
    function writeProducts(p) { localStorage.setItem(LS_PRODUCTS, JSON.stringify(p)); }

    function render() {
      const tbody = document.getElementById('adminProducts');
      const products = getProducts();
      tbody.innerHTML = products.map((p, i) => `<tr>
        <td>${p.name}</td>
        <td>${p.category}</td>
        <td>$${(p.price||0).toFixed(2)}</td>
        <td><img src="${p.image}" alt="${p.name}" class="admin-item-image"></td>
        <td><button class="btn btn-sm btn-primary btn-edit" data-id="${p.id}">Edit</button> <button class="btn btn-sm btn-danger btn-delete" data-id="${p.id}">Delete</button></td>
      </tr>`).join('');
    }

    document.getElementById('adminProductForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const id = document.getElementById('adminProductId').value || ('p'+Date.now());
      const name = document.getElementById('adminProductName').value;
      const category = document.getElementById('adminProductCategory').value;
      const price = parseFloat(document.getElementById('adminProductPrice').value) || 0;
      const image = document.getElementById('adminProductImage').value;
      const products = getProducts();
      const idx = products.findIndex(p=>p.id===id);
      const obj = { id, name, category, price, image };
      if (idx>=0) products[idx] = obj; else products.push(obj);
      writeProducts(products);
      render();
      e.target.reset();
    });

    document.getElementById('adminProducts').addEventListener('click', (e)=>{
      const ed = e.target.closest('.btn-edit');
      const del = e.target.closest('.btn-delete');
      if (ed) {
        const id = ed.dataset.id;
        const p = getProducts().find(x=>x.id===id);
        if (!p) return;
        document.getElementById('adminProductId').value = p.id;
        document.getElementById('adminProductName').value = p.name;
        document.getElementById('adminProductCategory').value = p.category;
        document.getElementById('adminProductPrice').value = p.price;
        document.getElementById('adminProductImage').value = p.image;
      } else if (del) {
        const id = del.dataset.id;
        const next = getProducts().filter(x=>x.id!==id);
        writeProducts(next);
        render();
      }
    });

    document.getElementById('adminReset').addEventListener('click', ()=>{ if(confirm('Overwrite products?')) { localStorage.removeItem(LS_PRODUCTS); render(); } });

    render();

  </script>
</body>
</html>